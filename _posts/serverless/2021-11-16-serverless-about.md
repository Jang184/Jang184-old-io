---
title: 서버리스 개요
category: serverless
tag: TIL
---

> 참고: 책 \<서버리스 웹 애플리케이션 구축>

## 서버리스 개요 

`Serverless`는 사용자(관리자 혹은 개발자)가 직접 관리해야 하는 서버가 거의 없다는 의미로 아마존이 `람다`에서 개념을 선 보인 이후 관련 서비스들이 계속 나오고 있다. 즉, 개발자가 서버 구성, 유지관리, 업데이트를 고려하지 않아도 된다는 뜻이다.

> 서버 유지보수로부터 자유로워지자 !

## 서버리스에 관해

서버리스 솔루션은 `이벤트 중심`이다. 기존의 솔루션은 코드가 항상 실행되고 있어 사용자가 시스템을 사용하지 않을 때도 시스템 자원을 사용하는데에 비해 서버리스 솔루션은 `사용자가 정보를 요청하는 이벤트가 발생하면 이벤트가 발생하면서 트리거는 코드를 선택하고 실행해 응답을 검색하도록 클라우드 공급 업체에게 알린다`. 


서버리스 아키텍쳐에서는 단일 요청을 처리하기 위해 시스템에 전체 코드 베이스를 로딩할 필요가 없다. 빠른 로딩을 위해 요청에 응답하는 데 필요한 코드만 선택해 실행한다. 이 솔루션의 일부가 `함수`로 참조된다. <u>즉, 필요할 때만 함수를 실행한다.</u>


### 서버리스 모델의 동작 순서

```js
1. 사용자는 클라우드 서비스 공급자가 제공한 주소로 요청을 전송한다.
2. 클라우드 서비스는 메세지를 기반으로 요청에 응답하는 데 사용할 패키지를 찾는다.
3. 패키지가 선택되면 패키지를 실행할 도커 컨테이너로 로드한다.
4. 도커 컨테이너가 실행되고 요청이 처리된다.
5. 생성된 응답을 요청한 사용자에게 전송한다.
```


요청을 처리하기 위해 패키지 또는 기능을 실행하는 데 `사용된 시간에 대해서만 요금이 청구`된다. 아무도 서비스를 사용하지 않는다면 비용을 지불할 필요가 없다. 또한, 애플리케이션에 접근하는 사용자가 급격하게 증가하는 경우 클라우드 서비스는 모든 요청을 동시에 처리하기 위해 새로운 인스턴스를 가동한다. 관련 클라우드 인스턴스 중 하나에 장애가 발생하면 `사용자의 간섭이나 추가 구성없이 자동으로` 다른 클라우드 인스턴스가 기동되고 사용할 수 있게 된다.

## AWS 서비스

### AWS IAM

AWS계정을 만들면 모든 권한을 가진 루트 사용자가 된다. 루트 사용자는 모든 서비스를 생성, 삭제할 수 있다. 실제 프로젝트에서 개발할 땐 모든 권한을 사용해서는 안된다. 정보 보안 측면에서 `최소 권한 원칙`은 사용자나 프로그램이 합법적인 목적을 위해 필요한 정보나 리소스에만 접근할 수 있어야 한다는 것이다.

### 아마존 코그니토

프레임워크와 서비스에서 복잡한 인증을 처리할 수 있는 솔루션을 탑재해 제작되고 있다. 코그니토는 이러한 솔루션 중 하나로 계정을 인증하는 방법을 제공하는 것 이상으로 여러 장치 간에 데이터를 쉽게 동기화하는 기능도 제공한다.


코그니토 계정으로 로그인하면 환경 설정, 사용자 프로필 또는 저장된 게임 데이터와 같이 사용자별 데이터를 저장하고 검색하는 데 사용되는 임시 AWS 토큰을 받는다.


코그니토는 사용자 풀과 아이디 풀 두 가지 서비스를 제공한다. 사용자 풀은 사용자 자격증명을 만들고 저장하는 위치고, 아이디 풀은 사용자가 AWS 자원에 접속할 수 있는 권한을 설정하는 곳이다.

### 아마존 S3

S3(Simple Storage Service)는 이미지, 로그파일, 백업 등 모든 유형의 파일을 저장할 수 있는 서비스다. 아마존은 각 파일을 객체로 부르고, `버킷`이라고 하는 루트 폴더를 이용해 파일을 저장한다. 사용하는 계정으로 여러 개의 버킷을 사용해 데이터를 효과적으로 구성할 수 있다. 버킷 안에는 폴더를 포함할 수 있지만 버킷을 포함할 수는 없다.


각 파일이 고유한 URL을 가지며 아마존 S3에서 해당 파일을 URL을 통해 서비스받을 수 있다.

> https://s3.amazonaws.com/bucketname/filename

이 형식의 고유 URL을 보장하기 위해 모든 계정에서 버킷 이름이 고유해야 한다.



S3는 매우 저렴한 스토리지 서비스이며, 저비용으로 서버리스 프론트엔드를 구축하기 위해 파일을 공유할 수 있는 유연성을 가진다. 버킷에 HTML, CSS, JS, IMG등 프론트엔드의 모든 정적 파일을 추가한다. 


### 아마존 루트53

Route53(루트53)은 사이트의 도메인을 구매하고 호스팅할 수 있는 `DNS`서비스를 제공한다. 외부 도메인 판매자로부터 도메인을 구입해 사용하거나 루트53에서 직접 도메인을 구입해 사용한다.

### 아마존 클라우트프론트

CloudFront는 `*CDN(Content Delivery Network)`이며 웹사이트 속도와 가용성 향상을 목적으로 하는 서비스다. 전 세계 60개 이상에 위치한 아마존의 인프라로 파일을 복사해 사용자와 파일 간의 거리를 줄임으로써 달성한다. 


비용을 절감하기 위해 클라우드프론트는 콘텐츠를 자동으로 전 세계로 복제하지 않는다. 특정 요구가 있을 경우에만 복제한다. 예를 들어 영국의 도시에서 요청을 하면 DNS는 요청을 가장 가까운 엣지로 라우팅한다. 만약 엣지의 네트워크 노드에 파일의 로컬 복사본이 없으면 캐시에 복사된다. 인근 도시의 다른 사용자가 동일한 파일을 요청하면 대기 시간이 짧고 응답 속도가 빠르다는 이점이 있다.

*CDN은 콘텐츠를 사용자에게 효율적으로 전달하는 기술로, 자주 사용되는 파일/데이터를 여러 서버에 나눠서 저장하여 서비스하는 네트워크다.

### 아마존 API Gateway

API 게이트웨이는 RESTful API를 작성하는 데 도움이 되는 서비스다. 자원을 구성하고 지원되는 HTTP 메소드를 설정하고 요청을 처리할 대상을 지정해야 한다. 이를 사용해 요청을 EC2 인스턴스 또는 외부 웹서버로 리디렉션할 수 있다.

람다 함수를 외부에 드러내려면 거쳐야 하는 거점으로 작동한다. 인증된 사용자만 코드를 트리거할 수 있도록 보안 통제를 설정할 수 있다.

### 아마존 ElastiCache

유연한 실시간 사용 사례를 지원하는 완전관리형 메모리 캐싱 서비스.